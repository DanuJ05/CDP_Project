import binascii
import re

# Hex ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡∏°‡∏≤ (‡∏ï‡∏±‡∏ß‡∏õ‡∏±‡∏ç‡∏´‡∏≤)
problem_hex = "e6a38fe4ad98d2a2"

def smart_decode_and_clean(hex_val):
    print(f"üîπ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå Hex: {hex_val}")
    
    try:
        # 1. ‡πÅ‡∏õ‡∏•‡∏á Hex ‡πÄ‡∏õ‡πá‡∏ô Bytes
        byte_data = binascii.unhexlify(hex_val)
        
        # 2. ‡∏•‡∏≠‡∏á‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™‡∏î‡πâ‡∏ß‡∏¢ UTF-8 (‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô Vertica)
        # errors='replace' ‡∏Ñ‡∏∑‡∏≠‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô‡∏û‡∏±‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ ‡∏≠‡∏¢‡πà‡∏≤ Error
        decoded_text = byte_data.decode('utf-8', errors='replace')
        print(f"üî∏ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö UTF-8 (‡∏î‡∏¥‡∏ö): {decoded_text}")
        
        # 3. ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡∏¢‡∏∞ (Sanitize)
        # ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞: ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢ (\u0e00-\u0e7f), ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© (a-zA-Z), ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (0-9), ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á, ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
        # ‡∏•‡∏ö‡∏û‡∏ß‡∏Å‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πà‡∏≤‡∏á‡∏î‡∏≤‡∏ß‡∏ó‡∏¥‡πâ‡∏á
        clean_text = "".join([c for c in decoded_text if is_valid_char(c)])
        
        return clean_text
        
    except Exception as e:
        return f"Error: {e}"

def is_valid_char(char):
    # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏ó‡∏µ‡πà‡∏î‡∏µ
    code = ord(char)
    return (
        0x0e00 <= code <= 0x0e7f or  # ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢
        32 <= code <= 126 or         # ‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç ‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
        code == 9 or code == 10      # Tab, Newline
    )

print("="*60)
print("‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•")
print("="*60)

final_result = smart_decode_and_clean(problem_hex)

print("-" * 60)
print(f"‚úÖ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡∏¢‡∏∞: '{final_result}'")
print("="*60)

# ‡∏•‡∏≠‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏™‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡πÄ‡∏à‡∏≠ (‡∏à‡∏µ‡∏ô‡∏õ‡∏ô‡πÑ‡∏ó‡∏¢)
print("\n[‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏Ñ‡∏™ ‡∏à‡∏µ‡∏ô‡∏õ‡∏ô‡πÑ‡∏ó‡∏¢]")
mock_mixed_hex = "e6a38f" + "e0b8ade0b8b2e0b884e0b8b2e0b8a3" # ‡∏à‡∏µ‡∏ô + ‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ (UTF-8 Hex)
print(f"Input ‡∏à‡∏≥‡∏•‡∏≠‡∏á: {mock_mixed_hex}")
print(f"‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: '{smart_decode_and_clean(mock_mixed_hex)}'")